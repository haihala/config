#!/usr/bin/env bash
set -euo pipefail

prompt() {
    options=("$@")
    selection=$(for I in ${!options[@]}; do
        echo "$((I + 1)): ${options[$I]}"
    done | fzf --print0 | cut -d ":" -f 1)
    if [[ -z $selection ]]; then
        exit 1
    else
        echo $((selection - 1))
    fi
}

legal_targets=("zsh" "fish" "sway" "nvim" "tmux" "zellij" "cfg")

if [ $# -eq 0 ]; then
    target=${legal_targets[$(prompt "${legal_targets[@]}")]}
else
    target=$1
fi

case $target in
"zsh")
    exec $EDITOR $(readlink $HOME/.zshrc)
    ;;
"fish")
    exec $EDITOR $(readlink $HOME/.config/fish)/config.fish
    ;;
"sway")
    exec $EDITOR $(readlink $HOME/.config/sway)/config
    ;;
"nvim" | "vim")
    exec $EDITOR $(readlink $HOME/.config/nvim)/init.lua
    ;;
"tmux")
    exec $EDITOR $(readlink $HOME/.tmux.conf)
    ;;
"zellij")
    exec $EDITOR $(readlink $HOME/.config/zellij)/config.kdl
    ;;
"cfg")
    exec $EDITOR $(which cfg)
    ;;
*)
    echo "Invalid target '$target'"
    ;;
esac
